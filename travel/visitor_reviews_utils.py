# visitor_reviews_utils.py - 방문자 리뷰 용어 표준화 및 분류
# ===================================================================================
# 파일명     : visitor_reviews_utils.py
# 작성자     : 하승주, 홍석원
# 최초작성일 : 2025-09-04
# 설명       : 네이버 장소의 방문자 리뷰 키워드를 표준 UI 태그로 변환 및
#              세분화된 12개 카테고리로 리뷰 특성 분류하는 유틸리티
# ===================================================================================
#
# 【주요 기능】
# - 네이버 장소의 방문자 리뷰 키워드를 표준 UI 태그로 변환
# - 세분화된 12개 카테고리로 리뷰 특성 분류
# - 리뷰 기반 필터링 시 정확한 매칭 지원
#
# 【분류 체계】
# 1. 가격/가성비: "가성비가 좋아요", "할인/적립을 잘 챙겨줘요"
# 2. 맛/음식: "맛있어요", "재료가 신선해요", "양이 많아요"
# 3. 분위기/경관: "뷰가 좋아요", "아늑해요", "야경이 멋져요"
# 4. 시설/청결: "깨끗해요", "시설이 깔끔해요", "화장실이 잘 되어있어요"
# 5. 서비스/친절: "친절해요", "설명이 자세해요", "전문성이 느껴져요"
# 6. 활동/경험: "놀거리가 많아요", "체험 프로그램이 다양해요"
# 7. 접근성/편의성: "주차하기 편해요", "대중교통이 편해요"
# 8. 상품/제품: "상품이 다양해요", "품질이 좋아요"
# 9. 대상: "혼밥하기 좋아요", "단체로 가기 좋아요"
# 10. 아이 관련: "아이와 가기 좋아요"
# 11. 반려동물 관련: "반려동물과 가기 좋아요"
# 12. 기타/특징: 기타 모든 특성
#
# 【작동 방식】
# 1. 입력된 리뷰 용어와 미리 정의된 키워드 사전 매칭
# 2. 정확한 문자열 일치 방식으로 분류
# 3. 매칭되지 않는 경우 "기타"로 분류
# 4. "정보 없음"은 필터 판단에서 제외
#
# 【데이터 기반】
# - 실제 네이버 리뷰에서 추출한 수백 개 키워드
# - 사용자가 자주 검색하는 특성별로 그룹핑
# - 지속적인 키워드 추가 및 분류 개선 가능
#
# 【사용처】
# - travel_logic.py: 리뷰 기반 필터링
# - DB의 visitor_reviews 필드 정규화
# ===================================================================================

def normalize_review_for_ui(review_term):
    """
    방문자 리뷰 용어를 분석하여 표준화된 UI용 카테고리명으로 변환합니다.
    """
    if not review_term:
        return "기타"

    # 1. 가격/가성비
    price_keywords = [
        "가격이 합리적이에요", "가성비가 좋아요", "비싼 만큼 가치있어요", "할인/적립을 잘 챙겨줘요"
    ]
    if review_term in price_keywords:
        return "가격/가성비"

    # 2. 맛/음식
    food_keywords = [
        "건강한 맛이에요", "고기 질이 좋아요", "과일이 맛있어요", "디저트가 맛있어요", "맛있어요",
        "먹거리가 풍부해요", "메뉴 구성이 알차요", "빵이 맛있어요", "신선해요", "양이 많아요",
        "음료가 맛있어요", "음식이 맛있어요", "음식이 빨리 나와요", "재료가 신선해요", "재료가 충분해요",
        "즉석조리 식품이 맛있어요", "차가 맛있어요", "코스요리가 알차요", "특별한 메뉴가 있어요",
        "현지 맛에 가까워요", "반찬이 잘 나와요", "잡내가 적어요", "직접 잘 구워줘요", "술이 다양해요"
    ]
    if review_term in food_keywords:
        return "맛/음식"

    # 3. 분위기/경관
    atmosphere_keywords = [
        "감각적이에요", "경관이 독특해요", "고급스러워요", "공간이 넓어요", "공포감이 낮아요",
        "공포감이 높아요", "그늘이 많아요", "디자인이 멋져요", "뷰가 좋아요", "분위기 관리가 철저해요",
        "분위기가 편안해요", "붐비지 않아요", "야경이 멋져요", "야외공간이 멋져요", "아기자기해요",
        "아늑해요", "음악이 좋아요", "음향이 좋아요", "인테리어가 멋져요", "자연 경관이 좋아요",
        "조용히 쉬기 좋아요", "차분한 분위기예요", "채광이 좋아요", "카페 같은 분위기에요", "컨셉이 독특해요",
        "트렌디해요", "프라이빗해요", "현장감이 느껴져요"
    ]
    if review_term in atmosphere_keywords:
        return "분위기/경관"

    # 4. 시설/청결
    facility_keywords = [
        "개수대가 잘 되어있어요", "공용시설 관리가 잘돼요", "관리가 잘 되어있어요", "깨끗해요",
        "냉난방이 잘돼요", "대기공간이 잘 되어있어요", "대여장비 상태가 좋아요", "동물 관리가 잘 되어있어요",
        "동물을 배려한 환경이에요", "레인 상태가 좋아요", "레인이 많아요", "룸이 넓어요", "룸이 잘 되어있어요",
        "매장이 넓어요", "매장이 청결해요", "모래가 고와요", "무대가 잘 보여요", "물이 깨끗해요",
        "물이 따뜻해요", "물이 맑아요", "부대시설이 잘 되어있어요", "사이트 간격이 넓어요", "샐러드바가 잘 되어있어요",
        "샤워실이 잘 되어있어요", "시설이 깔끔해요", "수질 관리가 잘돼요", "스파하기 좋아요", "안전하게 관리해요",
        "연습공간이 잘 되어있어요", "온수가 잘 나와요", "옷 관리가 잘 되어있어요", "장비 관리 상태가 좋아요",
        "전기 사용이 편해요", "좌석 간격이 넓어요", "좌석이 편해요", "침구가 좋아요", "클럽하우스가 잘 되어있어요",
        "파우더룸이 잘 되어있어요", "편의시설이 잘 되어있어요", "필드 상태가 좋아요", "화장실이 깨끗해요",
        "화장실이 잘 되어있어요", "휴게공간이 잘 되어있어요", "휴게시설이 잘 되어있어요", "최신 장비를 사용해요",
        "기구가 다양해요", "장치가 다양해요", "탕 종류가 다양해요", "수심이 다양해요", "그늘집이 잘 되어있어요"
    ]
    if review_term in facility_keywords:
        return "시설/청결"

    # 5. 서비스/친절
    service_keywords = [
        "강사님이 열정적이에요", "관객과 소통을 잘해요", "맞춤 수업을 잘해줘요", "맞춤 제작을 잘해요",
        "맞춤 지도를 잘해줘요", "맞춤 케어를 잘해줘요", "보정을 꼼꼼하게 해줘요", "상담이 자세해요",
        "선생님 실력이 좋아요", "선생님이 열정적이에요", "설명이 자세해요", "스타일 추천을 잘해줘요",
        "자세를 꼼꼼히 봐주세요", "자연스럽게 연출해줘요", "전문성이 느껴져요", "주문제작을 잘해줘요",
        "친절해요", "캐디의 진행이 매끄러워요", "참여자와 소통을 잘해요", "추천을 잘해줘요",
        "학생과 소통을 잘해요", "직접 잘 구워줘요", "예약 시간을 잘 지켜요"
    ]
    if review_term in service_keywords:
        return "서비스/친절"

    # 6. 활동/경험
    activity_experience_keywords = [
        "강습 받기 좋아요", "게임 종류가 다양해요", "공연이 재밌어요", "놀거리가 많아요", "놀이기구가 다양해요",
        "다양하게 연출하기 좋아요", "대화하기 좋아요", "독특한 책이 많아요", "말 교육이 잘 되어있어요",
        "물놀이하기 좋아요", "바비큐 해먹기 좋아요", "볼거리가 많아요", "부모도 쉬기 좋아요",
        "산책로가 잘 되어있어요", "서핑하기 좋아요", "세트장 구성이 다양해요", "수업 시간대가 다양해요",
        "수업 시간이 충분해요", "수업이 다양해요", "수업이 체계적이에요", "신간이 빨리 들어와요",
        "신기한 식물이 많아요", "신상품이 많아요", "야외에서 놀기 좋아요", "연습 시간이 자유로워요",
        "예쁜 소품이 많아요", "읽을만한 책이 많아요", "재미있는 테마가 많아요", "전시 구성이 알차요",
        "전시 테마가 재밌어요", "즐길 거리가 많아요", "집중하기 좋아요", "책 읽기 쾌적해요",
        "책 종류가 다양해요", "체험 프로그램이 다양해요", "체험 프로그램이 많아요", "코스가 길어요",
        "코스가 다양해요", "코스가 변별력 있어요", "코스가 재밌어요", "테마가 재미있어요",
        "트레이닝이 체계적이에요", "유익해요", "원데이 클래스가 알차요", "원하는 책을 찾기 쉬워요",
        "문제 종류가 다양해요", "문제가 논리적이에요", "문제가 신선해요", "피크닉하기 좋아요",
        "라이브공연이 훌륭해요", "스토리가 탄탄해요", "탐방로가 잘 되어있어요", "프로그램 구성이 알차요",
        "프로그램이 다양해요", "프로그램이 체계적이에요"
    ]
    if review_term in activity_experience_keywords:
        return "활동/경험"

    # 7. 접근성/편의성
    accessibility_keywords = [
        "근처에 갈 곳이 많아요", "대기 시스템이 편리해요", "대기시간이 짧아요", "대중교통이 편해요",
        "예약이 편리해요", "오래 머무르기 좋아요", "오르기 쉬워요", "운전이 쉬워요", "주차하기 편해요",
        "셔틀버스가 잘 되어있어요"
    ]
    if review_term in accessibility_keywords:
        return "접근성/편의성"

    # 8. 상품/제품
    product_keywords = [
        "꽃 조합이 예뻐요", "사이즈가 다양해요", "상품이 다양해요", "소품이 다양해요", "손질이 깔끔해요",
        "옷이 다양해요", "옷이 예뻐요", "요금제가 잘 되어있어요", "특색 있는 제품이 많아요", "포장이 깔끔해요",
        "품질이 좋아요", "베스트셀러가 많아요"
    ]
    if review_term in product_keywords:
        return "상품/제품"

    # 9. 대상
    target_audience_keywords = [
        "혼밥하기 좋아요", "혼술하기 좋아요",
        "단체로 가기 좋아요", "단체모임 하기 좋아요", "초보자에게도 적합해요"
    ]
    if review_term in target_audience_keywords:
        return "대상"

    # 11. 아이 관련
    child_keywords = [
        "아이와 가기 좋아요"
    ]
    if review_term in child_keywords:
        return "아이 관련"

    # 12. 반려동물 관련
    pet_keywords = [
        "반려동물과 가기 좋아요"
    ]
    if review_term in pet_keywords:
        return "반려동물 관련"

    # 10. 기타/특징
    other_keywords = [
        "정보 없음", "방문객이 많아요", "벌레 걱정 없어요", "붐비지 않아요", "비싼 만큼 가치있어요",
        "읽을만한 책이 많아요", "조용히 쉬기 좋아요", "종류가 다양해요", "집중하기 좋아요",
        "트렌디해요", "특별한 날 가기 좋아요"
    ]
    if review_term in other_keywords:
        return "기타/특징"

    return "기타" # Fallback for any unclassified terms